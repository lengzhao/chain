# Network Module - åŸºäºlibp2pçš„ç°ä»£åŒ–P2Pç½‘ç»œ

## æ¦‚è¿°

Networkæ¨¡å—åŸºäº[libp2p](https://github.com/libp2p)å®˜æ–¹åº“å®ç°ï¼Œæä¾›äº†å®Œæ•´çš„P2Pç½‘ç»œåŠŸèƒ½ï¼ŒåŒ…æ‹¬**è‡ªåŠ¨èŠ‚ç‚¹å‘ç°**ã€**DHTè‡ªåŠ¨ç®¡ç†**ã€**Gossipsubæ¶ˆæ¯ä¼ æ’­**ã€**æ™ºèƒ½è¿æ¥ç®¡ç†**ã€**ç§é’¥ç®¡ç†**ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## æ¶æ„è®¾è®¡

```mermaid
graph TB
    A[Network Module] --> B[libp2p Host]
    B --> C[DHT Service]
    B --> D[Gossipsub Service]
    B --> E[Peer Discovery]
    B --> F[Connection Manager]
    
    subgraph "DHT Service"
        C1[Kademlia DHT]
        C2[Peer Routing]
        C3[Content Routing]
        C4[Auto Management]
    end
    
    subgraph "Gossipsub Service"
        D1[Topic Management]
        D2[Message Broadcasting]
        D3[Subscription Handling]
        D4[Message Validation]
    end
    
    subgraph "Peer Discovery"
        E1[mDNS Discovery]
        E2[Bootstrap Discovery]
        E3[DHT Discovery]
    end
    
    subgraph "Connection Manager"
        F1[Connection Pool]
        F2[Peer Management]
        F3[Health Monitoring]
        F4[Auto Reconnection]
    end
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªåŠ¨èŠ‚ç‚¹å‘ç° ğŸ¯

Networkæ¨¡å—å…·å¤‡å¼ºå¤§çš„è‡ªåŠ¨èŠ‚ç‚¹å‘ç°èƒ½åŠ›ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ï¼š

#### å‘ç°æœºåˆ¶

1. **mDNSå‘ç°**: æœ¬åœ°ç½‘ç»œè‡ªåŠ¨å‘ç°
   - è‡ªåŠ¨å‘ç°åŒä¸€å±€åŸŸç½‘å†…çš„å…¶ä»–èŠ‚ç‚¹
   - é›¶é…ç½®ï¼Œå³æ’å³ç”¨
   - é€‚ç”¨äºæœ¬åœ°å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ

2. **Bootstrapå‘ç°**: åŸºäºé¢„é…ç½®èŠ‚ç‚¹çš„å‘ç°
   - è¿æ¥åˆ°é¢„é…ç½®çš„bootstrapèŠ‚ç‚¹
   - é€šè¿‡bootstrapèŠ‚ç‚¹å‘ç°æ›´å¤šèŠ‚ç‚¹
   - é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒ

3. **DHTå‘ç°**: åŸºäºDHTçš„èŠ‚ç‚¹å‘ç°
   - åˆ©ç”¨DHTç½‘ç»œè‡ªåŠ¨å‘ç°èŠ‚ç‚¹
   - å»ä¸­å¿ƒåŒ–ï¼Œæ— éœ€ä¸­å¿ƒåŒ–æœåŠ¡å™¨
   - æ”¯æŒå¤§è§„æ¨¡ç½‘ç»œ

#### å‘ç°ä¼˜å…ˆçº§

```mermaid
graph LR
    A[å¯åŠ¨] --> B[è¿æ¥BootstrapèŠ‚ç‚¹]
    B --> C[å¯åŠ¨DHTå‘ç°]
    C --> D[å¯åŠ¨mDNSå‘ç°]
    D --> E[æŒç»­å‘ç°æ–°èŠ‚ç‚¹]
```

### 2. DHTè‡ªåŠ¨ç®¡ç† ğŸ¯

DHTæœåŠ¡å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„ï¼š

#### è‡ªåŠ¨ç®¡ç†ç‰¹æ€§

- **è‡ªåŠ¨å¼•å¯¼**: å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥åˆ°DHTç½‘ç»œ
- **è·¯ç”±è¡¨ç®¡ç†**: è‡ªåŠ¨ç»´æŠ¤Kademliaè·¯ç”±è¡¨
- **èŠ‚ç‚¹å¥åº·æ£€æŸ¥**: å®šæœŸæ£€æŸ¥èŠ‚ç‚¹è¿é€šæ€§
- **ç½‘ç»œåˆ†åŒºæ¢å¤**: è‡ªåŠ¨æ£€æµ‹å’Œæ¢å¤ç½‘ç»œåˆ†åŒº
- **è´Ÿè½½å‡è¡¡**: è‡ªåŠ¨å¹³è¡¡ç½‘ç»œè´Ÿè½½

#### DHTåŠŸèƒ½

- **èŠ‚ç‚¹å‘ç°**: è‡ªåŠ¨å‘ç°ç½‘ç»œä¸­çš„å…¶ä»–èŠ‚ç‚¹
- **å†…å®¹è·¯ç”±**: åŸºäºå†…å®¹å“ˆå¸Œçš„å†…å®¹æŸ¥æ‰¾
- **ç½‘ç»œæ‹“æ‰‘**: ç»´æŠ¤å»ä¸­å¿ƒåŒ–çš„ç½‘ç»œæ‹“æ‰‘
- **æ•…éšœæ¢å¤**: è‡ªåŠ¨å¤„ç†èŠ‚ç‚¹æ•…éšœå’Œç½‘ç»œåˆ†åŒº

#### DHT vs è¿æ¥ç®¡ç†çš„å…³ç³»

```mermaid
graph TB
    A[DHTæœåŠ¡] --> B[èŠ‚ç‚¹å‘ç°]
    A --> C[è·¯ç”±è¡¨ç»´æŠ¤]
    A --> D[å†…å®¹è·¯ç”±]
    
    E[è¿æ¥ç®¡ç†] --> F[è¿æ¥æ± ç»´æŠ¤]
    E --> G[å¥åº·æ£€æŸ¥]
    E --> H[è‡ªåŠ¨é‡è¿]
    E --> I[è´Ÿè½½å‡è¡¡]
    
    B --> J[å‘ç°èŠ‚ç‚¹åœ°å€]
    J --> F
    F --> K[å»ºç«‹TCPè¿æ¥]
    K --> G
```

**ä¸ºä»€ä¹ˆæœ‰äº†DHTè¿˜éœ€è¦è¿æ¥ç®¡ç†ï¼Ÿ**

1. **èŒè´£åˆ†å·¥**
   - **DHT**: è´Ÿè´£èŠ‚ç‚¹å‘ç°å’Œè·¯ç”±ä¿¡æ¯ï¼Œä¸è´Ÿè´£TCPè¿æ¥ç»´æŠ¤
   - **è¿æ¥ç®¡ç†**: è´Ÿè´£å®é™…çš„TCPè¿æ¥ç»´æŠ¤ã€å¥åº·æ£€æŸ¥ã€è‡ªåŠ¨é‡è¿

2. **å®é™…éœ€æ±‚**
   - åº”ç”¨éœ€è¦çŸ¥é“å“ªäº›èŠ‚ç‚¹å·²è¿æ¥
   - éœ€è¦å¤„ç†è¿æ¥æ–­å¼€å’Œé‡è¿
   - éœ€è¦ç®¡ç†è¿æ¥æ•°é‡å’Œè´¨é‡
   - éœ€è¦è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»

3. **è‡ªåŠ¨åŒ–ç¨‹åº¦**
   - **DHTå±‚é¢**: å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
   - **è¿æ¥å±‚é¢**: åŸºäºDHTå‘ç°ç»“æœï¼Œè‡ªåŠ¨å»ºç«‹å’Œç»´æŠ¤è¿æ¥

### 3. Gossipsub æ¶ˆæ¯ä¼ æ’­

åŸºäºGossipsubåè®®çš„é«˜æ•ˆæ¶ˆæ¯ä¼ æ’­ç³»ç»Ÿï¼š

#### æ ¸å¿ƒç‰¹æ€§

- **é«˜æ•ˆå¹¿æ’­**: åŸºäºgossipçš„æ¶ˆæ¯ä¼ æ’­ï¼Œå‡å°‘ç½‘ç»œå¼€é”€
- **ä¸»é¢˜ç®¡ç†**: æ”¯æŒå¤šä¸ªä¸»é¢˜çš„è®¢é˜…å’Œå‘å¸ƒ
- **æ¶ˆæ¯éªŒè¯**: å†…ç½®æ¶ˆæ¯ç­¾åå’ŒéªŒè¯
- **ç½‘ç»œåˆ†åŒºå®¹é”™**: è‡ªåŠ¨å¤„ç†ç½‘ç»œåˆ†åŒº
- **æ¶ˆæ¯å»é‡**: è‡ªåŠ¨å»é™¤é‡å¤æ¶ˆæ¯

#### Gossipsub API

```go
// å¹¿æ’­æ¶ˆæ¯
func (n *Network) BroadcastMessage(topic string, data []byte) error

// è®¢é˜…ä¸»é¢˜
func (n *Network) SubscribeToTopic(topicName string) error

// è·å–ä¸»é¢˜åˆ—è¡¨
func (n *Network) ListTopics() []string

// è·å–ä¸»é¢˜ä¸­çš„èŠ‚ç‚¹
func (n *Network) GetTopicPeers(topicName string) []peer.ID

// æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨
func (n *Network) RegisterMessageHandler(topic string, handler MessageHandler)

// è·å–Gossipsubå®ä¾‹
func (n *Network) GetPubsub() *pubsub.PubSub
```

### 4. æ™ºèƒ½è¿æ¥ç®¡ç†

åŸºäºDHTå‘ç°çš„è‡ªåŠ¨åŒ–è¿æ¥ç®¡ç†ç³»ç»Ÿï¼š

#### ä¸DHTçš„åä½œå…³ç³»

```mermaid
graph LR
    A[DHTå‘ç°èŠ‚ç‚¹] --> B[è·å–èŠ‚ç‚¹åœ°å€]
    B --> C[è¯„ä¼°è¿æ¥éœ€æ±‚]
    C --> D[å»ºç«‹TCPè¿æ¥]
    D --> E[è¿æ¥æ± ç®¡ç†]
    E --> F[å¥åº·ç›‘æ§]
    F --> G[è‡ªåŠ¨é‡è¿]
```

#### ç®¡ç†ç‰¹æ€§

- **åŸºäºDHTå‘ç°**: åˆ©ç”¨DHTå‘ç°çš„èŠ‚ç‚¹ä¿¡æ¯å»ºç«‹è¿æ¥
- **è¿æ¥æ± ç®¡ç†**: è‡ªåŠ¨ç®¡ç†è¿æ¥æ•°é‡ï¼Œé¿å…è¿æ¥è¿‡å¤š
- **å¥åº·ç›‘æ§**: å®šæœŸæ£€æŸ¥è¿æ¥å¥åº·çŠ¶æ€
- **è‡ªåŠ¨é‡è¿**: è¿æ¥æ–­å¼€æ—¶è‡ªåŠ¨é‡è¿
- **è´Ÿè½½å‡è¡¡**: æ™ºèƒ½åˆ†é…è¿æ¥è´Ÿè½½
- **è¿æ¥ä¼˜åŒ–**: è‡ªåŠ¨ä¼˜åŒ–è¿æ¥è´¨é‡

#### è¿æ¥ç®¡ç†API

```go
// è·å–è¿æ¥çš„èŠ‚ç‚¹
func (n *Network) GetPeers() []peer.ID

// è¿æ¥åˆ°æŒ‡å®šèŠ‚ç‚¹
func (n *Network) ConnectToPeer(addr string) error

// æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦å·²è¿æ¥
func (n *Network) IsPeerConnected(peerID peer.ID) bool

// è·å–è¿æ¥ç»Ÿè®¡ä¿¡æ¯
func (n *Network) GetConnectionStats() map[string]interface{}
```

### 5. ç§é’¥ç®¡ç†

è‡ªåŠ¨åŒ–çš„ç§é’¥ç”Ÿæˆå’Œç®¡ç†ç³»ç»Ÿï¼š

#### ç‰¹æ€§

- **è‡ªåŠ¨ç”Ÿæˆ**: é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆç§é’¥
- **æ–‡ä»¶æŒä¹…åŒ–**: æ”¯æŒç§é’¥æ–‡ä»¶æŒä¹…åŒ–å­˜å‚¨
- **å®‰å…¨å­˜å‚¨**: ä½¿ç”¨PEMæ ¼å¼å®‰å…¨å­˜å‚¨ç§é’¥
- **æƒé™æ§åˆ¶**: ç§é’¥æ–‡ä»¶è®¾ç½®ä¸¥æ ¼çš„æƒé™æ§åˆ¶

#### ç§é’¥ç®¡ç†API

```go
// ä¿å­˜ç§é’¥åˆ°æ–‡ä»¶
func SavePrivateKeyToFile(priv crypto.PrivKey, path string) error

// ä»æ–‡ä»¶åŠ è½½ç§é’¥
func loadPrivateKeyFromFile(path string) (crypto.PrivKey, error)
```

## é…ç½®è¯´æ˜

### ç½‘ç»œé…ç½®

```yaml
network:
  # åŸºç¡€é…ç½®
  port: 26656                    # ç›‘å¬ç«¯å£
  host: "0.0.0.0"               # ç›‘å¬åœ°å€
  max_peers: 50                 # æœ€å¤§è¿æ¥èŠ‚ç‚¹æ•°
  
  # BootstrapèŠ‚ç‚¹é…ç½®
  bootstrap_peers:
    - "/ip4/192.168.1.100/tcp/26656/p2p/QmYyQSo1c1Ym7orWxLYvCrM2EmxFTANf8wXmmE7DWjhx5N"
    - "/ip4/192.168.1.101/tcp/26656/p2p/QmYyQSo1c1Ym7orWxLYvCrM2EmxFTANf8wXmmE7DWjhx5N"
  
  # ç§é’¥é…ç½®
  private_key_path: "./private_key.pem"  # ç§é’¥æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
```

### é…ç½®å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `port` | int | 26656 | ç½‘ç»œç›‘å¬ç«¯å£ |
| `host` | string | "0.0.0.0" | ç½‘ç»œç›‘å¬åœ°å€ |
| `max_peers` | int | 50 | æœ€å¤§è¿æ¥èŠ‚ç‚¹æ•° |
| `bootstrap_peers` | []string | [] | DHT bootstrapèŠ‚ç‚¹åˆ—è¡¨ |
| `private_key_path` | string | "" | ç§é’¥æ–‡ä»¶è·¯å¾„ï¼Œä¸ºç©ºæ—¶è‡ªåŠ¨ç”Ÿæˆ |

## ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºç¡€ä½¿ç”¨

```go
package main

import (
    "context"
    "log"
    "time"
    
    "github.com/govm-net/chain/config"
    "github.com/govm-net/chain/network"
    "github.com/govm-net/chain/consensus"
    "github.com/govm-net/chain/execution"
    "github.com/govm-net/chain/storage"
)

func main() {
    // åˆ›å»ºé…ç½®
    cfg := config.NetworkConfig{
        Port:     26656,
        Host:     "0.0.0.0",
        MaxPeers: 50,
        BootstrapPeers: []string{
            "/ip4/192.168.1.100/tcp/26656/p2p/QmYyQSo1c1Ym7orWxLYvCrM2EmxFTANf8wXmmE7DWjhx5N",
        },
    }
    
    // åˆ›å»ºå­˜å‚¨å®ä¾‹
    storage, err := storage.New(config.StorageConfig{
        DataDir:     "./data",
        MaxSize:     1024 * 1024 * 1024,
        CacheSize:   1000,
        Compression: true,
    })
    if err != nil {
        log.Fatal(err)
    }
    
    // åˆ›å»ºæ‰§è¡Œå¼•æ“
    exec, err := execution.New(config.ExecutionConfig{
        MaxThreads: 8,
        BatchSize:  100,
        Timeout:    5000,
    }, storage)
    if err != nil {
        log.Fatal(err)
    }
    
    // åˆ›å»ºå…±è¯†å®ä¾‹
    consensus, err := consensus.New(config.ConsensusConfig{
        Algorithm: "pbft",
        MaxFaulty: 1,
        BlockTime: 1000,
        BatchSize: 1000,
    }, exec, storage)
    if err != nil {
        log.Fatal(err)
    }
    
    // åˆ›å»ºç½‘ç»œå®ä¾‹
    net, err := network.New(cfg, consensus)
    if err != nil {
        log.Fatal(err)
    }
    
    // å¯åŠ¨ç½‘ç»œï¼ˆè‡ªåŠ¨å¼€å§‹èŠ‚ç‚¹å‘ç°å’ŒDHTç®¡ç†ï¼‰
    if err := net.Start(); err != nil {
        log.Fatal(err)
    }
    
    // æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨
    net.RegisterMessageHandler("blocks", func(peerID peer.ID, data []byte) error {
        log.Printf("æ”¶åˆ°åŒºå—æ¶ˆæ¯: %s", string(data))
        return nil
    })
    
    // è®¢é˜…ä¸»é¢˜
    if err := net.SubscribeToTopic("blocks"); err != nil {
        log.Fatal(err)
    }
    
    // å¹¿æ’­æ¶ˆæ¯
    if err := net.BroadcastMessage("blocks", []byte("Hello, World!")); err != nil {
        log.Fatal(err)
    }
    
    // ç­‰å¾…ç½‘ç»œç¨³å®š
    time.Sleep(10 * time.Second)
    
    // æŸ¥çœ‹ç½‘ç»œçŠ¶æ€
    peers := net.GetPeers()
    log.Printf("å½“å‰è¿æ¥èŠ‚ç‚¹æ•°: %d", len(peers))
    
    // æŸ¥çœ‹è¿æ¥ç»Ÿè®¡ä¿¡æ¯
    stats := net.GetConnectionStats()
    log.Printf("è¿æ¥ç»Ÿè®¡: %+v", stats)
    
    // ç­‰å¾…
    select {}
}
```

### 2. èŠ‚ç‚¹å‘ç°ç›‘æ§

```go
// ç›‘æ§èŠ‚ç‚¹å‘ç°è¿‡ç¨‹
go func() {
    ticker := time.NewTicker(30 * time.Second)
    defer ticker.Stop()
    
    for {
        select {
        case <-ticker.C:
            peers := net.GetPeers()
            stats := net.GetConnectionStats()
            
            log.Printf("ç½‘ç»œçŠ¶æ€:")
            log.Printf("  - è¿æ¥èŠ‚ç‚¹æ•°: %d", len(peers))
            log.Printf("  - æœ€å¤§èŠ‚ç‚¹æ•°: %v", stats["max_peers"])
            log.Printf("  - ä½¿ç”¨ç‡: %.2f%%", stats["usage_percentage"])
            log.Printf("  - BootstrapèŠ‚ç‚¹æ•°: %v", stats["bootstrap_peers"])
        }
    }
}()
```

### 3. mDNSçŠ¶æ€ç›‘æ§

```go
// æ£€æŸ¥mDNSçŠ¶æ€
if net.IsMDNSEnabled() {
    log.Println("mDNSå·²å¯ç”¨")
    
    status := net.GetMDNSStatus()
    log.Printf("mDNSçŠ¶æ€: %+v", status)
} else {
    log.Println("mDNSæœªå¯ç”¨")
}
```

### 4. ä¸»é¢˜ç®¡ç†

```go
// åˆ—å‡ºæ‰€æœ‰ä¸»é¢˜
topics := net.ListTopics()
log.Printf("å½“å‰ä¸»é¢˜: %v", topics)

// è·å–ä¸»é¢˜ä¸­çš„èŠ‚ç‚¹
for _, topic := range topics {
    peers := net.GetTopicPeers(topic)
    log.Printf("ä¸»é¢˜ %s ä¸­çš„èŠ‚ç‚¹: %v", topic, peers)
}
```

## è‡ªåŠ¨ç®¡ç†ç‰¹æ€§

### 1. èŠ‚ç‚¹è‡ªåŠ¨å‘ç°

- **é›¶é…ç½®**: å¯åŠ¨åè‡ªåŠ¨å¼€å§‹èŠ‚ç‚¹å‘ç°
- **å¤šæœºåˆ¶**: åŒæ—¶ä½¿ç”¨å¤šç§å‘ç°æœºåˆ¶
- **æ™ºèƒ½é€‰æ‹©**: æ ¹æ®ç½‘ç»œç¯å¢ƒæ™ºèƒ½é€‰æ‹©å‘ç°æ–¹å¼
- **æŒç»­å‘ç°**: æŒç»­å‘ç°æ–°èŠ‚ç‚¹ï¼Œä¿æŒç½‘ç»œæ´»è·ƒ

### 2. DHTè‡ªåŠ¨ç®¡ç†

- **è‡ªåŠ¨å¼•å¯¼**: å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥åˆ°DHTç½‘ç»œ
- **è·¯ç”±ç»´æŠ¤**: è‡ªåŠ¨ç»´æŠ¤Kademliaè·¯ç”±è¡¨
- **èŠ‚ç‚¹å¥åº·**: å®šæœŸæ£€æŸ¥èŠ‚ç‚¹å¥åº·çŠ¶æ€
- **æ•…éšœæ¢å¤**: è‡ªåŠ¨å¤„ç†èŠ‚ç‚¹æ•…éšœå’Œç½‘ç»œåˆ†åŒº

### 3. è¿æ¥è‡ªåŠ¨ç®¡ç†

- **åŸºäºDHTå‘ç°**: åˆ©ç”¨DHTå‘ç°çš„èŠ‚ç‚¹ä¿¡æ¯è‡ªåŠ¨å»ºç«‹è¿æ¥
- **è¿æ¥æ± **: è‡ªåŠ¨ç®¡ç†è¿æ¥æ•°é‡
- **å¥åº·æ£€æŸ¥**: å®šæœŸæ£€æŸ¥è¿æ¥å¥åº·çŠ¶æ€
- **è‡ªåŠ¨é‡è¿**: è¿æ¥æ–­å¼€æ—¶è‡ªåŠ¨é‡è¿
- **è´Ÿè½½å‡è¡¡**: æ™ºèƒ½åˆ†é…è¿æ¥è´Ÿè½½

### 4. åä½œæµç¨‹

```mermaid
graph TD
    A[å¯åŠ¨] --> B[DHTå¼•å¯¼]
    B --> C[èŠ‚ç‚¹å‘ç°]
    C --> D[è·å–èŠ‚ç‚¹åœ°å€]
    D --> E[è¯„ä¼°è¿æ¥éœ€æ±‚]
    E --> F[å»ºç«‹è¿æ¥]
    F --> G[è¿æ¥æ± ç®¡ç†]
    G --> H[å¥åº·ç›‘æ§]
    H --> I[è‡ªåŠ¨é‡è¿]
    I --> C
```

## æ€§èƒ½ç‰¹æ€§

### 1. é«˜ååé‡

- **å¹¶è¡Œå¤„ç†**: æ”¯æŒå¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†æ¶ˆæ¯
- **å¼‚æ­¥æ“ä½œ**: æ‰€æœ‰ç½‘ç»œæ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„
- **è¿æ¥å¤ç”¨**: å¤ç”¨TCPè¿æ¥ï¼Œå‡å°‘è¿æ¥å¼€é”€
- **æ¶ˆæ¯æ‰¹å¤„ç†**: æ”¯æŒæ¶ˆæ¯æ‰¹é‡å¤„ç†

### 2. ä½å»¶è¿Ÿ

- **ç›´æ¥è¿æ¥**: èŠ‚ç‚¹é—´ç›´æ¥è¿æ¥ï¼Œæ— ä¸­é—´ä»£ç†
- **æ¶ˆæ¯è·¯ç”±**: æ™ºèƒ½æ¶ˆæ¯è·¯ç”±ï¼Œå‡å°‘ç½‘ç»œè·³æ•°
- **è¿æ¥æ± **: é¢„å»ºç«‹è¿æ¥æ± ï¼Œå‡å°‘è¿æ¥å»ºç«‹æ—¶é—´
- **ç¼“å­˜æœºåˆ¶**: å¤šçº§ç¼“å­˜ï¼Œæé«˜å“åº”é€Ÿåº¦

### 3. é«˜å¯ç”¨æ€§

- **è‡ªåŠ¨é‡è¿**: è¿æ¥æ–­å¼€æ—¶è‡ªåŠ¨é‡è¿
- **æ•…éšœè½¬ç§»**: èŠ‚ç‚¹æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨èŠ‚ç‚¹
- **è´Ÿè½½å‡è¡¡**: æ™ºèƒ½è´Ÿè½½å‡è¡¡ï¼Œé¿å…å•ç‚¹æ•…éšœ
- **å¥åº·æ£€æŸ¥**: å®šæœŸå¥åº·æ£€æŸ¥ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

## ç›‘æ§å’Œè°ƒè¯•

### 1. ç½‘ç»œçŠ¶æ€ç›‘æ§

```go
// è·å–ç½‘ç»œçŠ¶æ€
func (n *Network) GetNetworkStats() map[string]interface{} {
    return map[string]interface{}{
        "connected_peers": len(n.GetPeers()),
        "connection_stats": n.GetConnectionStats(),
        "topics": n.ListTopics(),
        "mdns_status": n.GetMDNSStatus(),
    }
}
```

### 2. è¿æ¥ç»Ÿè®¡ä¿¡æ¯

```go
// è·å–è¿æ¥ç»Ÿè®¡ä¿¡æ¯
stats := net.GetConnectionStats()
// è¿”å›å­—æ®µ:
// - current_peers: å½“å‰è¿æ¥èŠ‚ç‚¹æ•°
// - max_peers: æœ€å¤§èŠ‚ç‚¹æ•°
// - usage_percentage: ä½¿ç”¨ç‡ç™¾åˆ†æ¯”
// - bootstrap_peers: bootstrapèŠ‚ç‚¹æ•°é‡
```

### 3. mDNSçŠ¶æ€ç›‘æ§

```go
// è·å–mDNSçŠ¶æ€
status := net.GetMDNSStatus()
// è¿”å›å­—æ®µ:
// - enabled: æ˜¯å¦å¯ç”¨
// - service: æœåŠ¡æ˜¯å¦åˆ›å»º
// - service_name: æœåŠ¡åç§°
```

## æœ€ä½³å®è·µ

### 1. é…ç½®ä¼˜åŒ–

- **åˆç†è®¾ç½®è¿æ¥æ•°**: æ ¹æ®ç½‘ç»œè§„æ¨¡è®¾ç½®åˆé€‚çš„æœ€å¤§è¿æ¥æ•°
- **é…ç½®BootstrapèŠ‚ç‚¹**: é…ç½®è¶³å¤Ÿçš„bootstrapèŠ‚ç‚¹ç¡®ä¿ç½‘ç»œè¿é€šæ€§
- **ç§é’¥ç®¡ç†**: ç”Ÿäº§ç¯å¢ƒå»ºè®®æŒ‡å®šç§é’¥æ–‡ä»¶è·¯å¾„
- **ç›‘æ§ç½‘ç»œçŠ¶æ€**: å®šæœŸç›‘æ§ç½‘ç»œçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡

### 2. é”™è¯¯å¤„ç†

- **ä¼˜é›…é™çº§**: ç½‘ç»œæ•…éšœæ—¶å®ç°ä¼˜é›…é™çº§
- **é‡è¯•æœºåˆ¶**: å®ç°åˆç†çš„é‡è¯•æœºåˆ¶
- **è¶…æ—¶è®¾ç½®**: è®¾ç½®åˆé€‚çš„è¶…æ—¶æ—¶é—´
- **é”™è¯¯æ—¥å¿—**: è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

### 3. æ€§èƒ½ä¼˜åŒ–

- **è¿æ¥å¤ç”¨**: å°½å¯èƒ½å¤ç”¨è¿æ¥
- **æ¶ˆæ¯æ‰¹å¤„ç†**: æ‰¹é‡å¤„ç†æ¶ˆæ¯å‡å°‘ç½‘ç»œå¼€é”€
- **ç¼“å­˜ç­–ç•¥**: å®ç°åˆé€‚çš„ç¼“å­˜ç­–ç•¥
- **è´Ÿè½½å‡è¡¡**: å®ç°è´Ÿè½½å‡è¡¡é¿å…å•ç‚¹ç“¶é¢ˆ

## æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

#### èŠ‚ç‚¹å‘ç°å¤±è´¥
- æ£€æŸ¥ç½‘ç»œé…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤é˜²ç«å¢™è®¾ç½®
- éªŒè¯bootstrapèŠ‚ç‚¹åœ°å€

#### æ¶ˆæ¯ä¸¢å¤±
- æ£€æŸ¥æ¶ˆæ¯å¤„ç†å™¨æ˜¯å¦æ­£ç¡®æ³¨å†Œ
- ç¡®è®¤ä¸»é¢˜åç§°æ˜¯å¦æ­£ç¡®
- éªŒè¯ç½‘ç»œè¿é€šæ€§

#### æ€§èƒ½é—®é¢˜
- æ£€æŸ¥è¿æ¥æ•°æ˜¯å¦è¿‡å¤š
- ç¡®è®¤æ¶ˆæ¯å¤§å°æ˜¯å¦åˆç†
- éªŒè¯ç½‘ç»œå¸¦å®½æ˜¯å¦å……è¶³

### 2. è°ƒè¯•æ­¥éª¤

1. **æ£€æŸ¥æ—¥å¿—**: æŸ¥çœ‹è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
2. **éªŒè¯é…ç½®**: ç¡®è®¤é…ç½®å‚æ•°æ˜¯å¦æ­£ç¡®
3. **æµ‹è¯•è¿é€šæ€§**: æµ‹è¯•ç½‘ç»œè¿é€šæ€§
4. **ç›‘æ§æŒ‡æ ‡**: ç›‘æ§ç½‘ç»œæ€§èƒ½æŒ‡æ ‡
5. **åˆ†ææ‹“æ‰‘**: åˆ†æç½‘ç»œæ‹“æ‰‘ç»“æ„

## ç‰ˆæœ¬å†å²

### v2.0.0 (å½“å‰ç‰ˆæœ¬)
- åŸºäºlibp2p v0.43.0+é‡æ„
- **è‡ªåŠ¨èŠ‚ç‚¹å‘ç°**: æ”¯æŒå¤šç§è‡ªåŠ¨å‘ç°æœºåˆ¶
- **DHTè‡ªåŠ¨ç®¡ç†**: å®Œå…¨è‡ªåŠ¨åŒ–çš„DHTç®¡ç†
- **Gossipsubæ¶ˆæ¯ä¼ æ’­**: é«˜æ•ˆçš„æ¶ˆæ¯ä¼ æ’­ç³»ç»Ÿ
- **æ™ºèƒ½è¿æ¥ç®¡ç†**: è‡ªåŠ¨åŒ–çš„è¿æ¥ç®¡ç†
- **ç§é’¥ç®¡ç†**: è‡ªåŠ¨åŒ–çš„ç§é’¥ç”Ÿæˆå’Œç®¡ç†
- **ç›‘æ§å’Œè°ƒè¯•**: å®Œæ•´çš„ç›‘æ§å’Œè°ƒè¯•åŠŸèƒ½

### v1.0.0
- åŸºç¡€P2Pç½‘ç»œåŠŸèƒ½
- ç®€å•çš„èŠ‚ç‚¹å‘ç°
- åŸºæœ¬çš„æ¶ˆæ¯ä¼ é€’

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚

## å‚è€ƒé“¾æ¥

- [libp2på®˜æ–¹æ–‡æ¡£](https://docs.libp2p.io/)
- [go-libp2p GitHub](https://github.com/libp2p/go-libp2p)
- [go-libp2p-kad-dht](https://github.com/libp2p/go-libp2p-kad-dht)
- [go-libp2p-pubsub](https://github.com/libp2p/go-libp2p-pubsub)
